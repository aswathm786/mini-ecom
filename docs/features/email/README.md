# Email System Documentation

Complete guide to email configuration and management.

## üìã Contents

- [SMTP Setup](smtp-setup.md) - Configure email sending
- [OAuth Setup](oauth-setup.md) - Google OAuth for Gmail

## üìß Email Features

### Transactional Emails

**Customer Emails:**
- Welcome email (on registration)
- Email verification
- Password reset
- Order confirmation
- Shipping notification
- Delivery confirmation
- Support ticket updates

**Admin Emails:**
- New order notification
- Low stock alerts
- Customer inquiry notifications
- System alerts

### Email Templates

All emails use customizable templates with:
- Store branding
- Dynamic content
- Responsive design
- Plain text fallback

## üöÄ Quick Setup

### Option 1: Gmail (Free, Limited)

1. Enable 2-Step Verification
2. Generate App Password: https://myaccount.google.com/apppasswords
3. Configure:

```bash
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password_here
SMTP_FROM="Your Store <noreply@yourstore.com>"
```

**Limits:** 500 emails/day

### Option 2: SendGrid (Recommended)

1. Sign up: https://sendgrid.com
2. Create API key
3. Configure:

```bash
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=your_sendgrid_api_key
SMTP_FROM="Your Store <noreply@yourstore.com>"
```

**Free tier:** 100 emails/day

### Option 3: Mailgun

1. Sign up: https://mailgun.com
2. Verify domain
3. Get SMTP credentials
4. Configure:

```bash
SMTP_HOST=smtp.mailgun.org
SMTP_PORT=587
SMTP_USER=postmaster@your-domain.com
SMTP_PASS=your_mailgun_password
SMTP_FROM="Your Store <noreply@your-domain.com>"
```

**Free tier:** 5,000 emails/month

## ‚öôÔ∏è Configuration

### Environment Variables

```bash
# Enable emails
ENABLE_EMAIL=true

# SMTP Settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_password

# From address
SMTP_FROM="Store Name <noreply@yourstore.com>"

# Reply-to address
SMTP_REPLY_TO=support@yourstore.com
```

### Admin Panel Configuration

Settings ‚Üí Email:
- SMTP server settings
- Test email function
- Email template customization
- Email footer/signature

## üß™ Testing

### Test Email Configuration

1. Go to Admin ‚Üí Settings ‚Üí Email
2. Click "Send Test Email"
3. Enter your email address
4. Click Send
5. Check inbox (and spam folder)

### Command Line Test

```bash
# Using admin panel API
curl -X POST https://yourstore.com/api/admin/email/test \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{"to":"test@example.com"}'
```

## üìù Email Templates

### Customize Templates

Admin Panel ‚Üí Settings ‚Üí Email Templates:
- Welcome email
- Order confirmation
- Shipping notification
- Password reset

### Template Variables

Available in all templates:
- `{{storeName}}` - Store name
- `{{customerName}}` - Customer name
- `{{orderNumber}}` - Order number
- `{{trackingNumber}}` - Shipping tracking
- `{{resetLink}}` - Password reset link
- `{{verificationLink}}` - Email verification link

## üîí Security

### SPF Record

Add to DNS:
```
Type: TXT
Name: @
Value: v=spf1 include:_spf.google.com ~all
```
(Adjust for your email provider)

### DKIM Record

Generated by your email provider. Add to DNS as instructed.

### DMARC Record

```
Type: TXT
Name: _dmarc
Value: v=DMARC1; p=none; rua=mailto:dmarc@yourstore.com
```

## üìä Email Delivery

### Monitor Delivery

- Check email provider dashboard
- Monitor bounce rates
- Track open rates (if enabled)
- Review spam complaints

### Improve Deliverability

- Use verified domain
- Configure SPF/DKIM/DMARC
- Avoid spam trigger words
- Include unsubscribe link
- Maintain clean email list
- Send relevant content

## üÜò Common Issues

### Emails Not Sending

**Check:**
- SMTP credentials correct
- SMTP host/port correct
- Firewall allows SMTP port
- Email provider not blocked

**Solution:**
```bash
# Test SMTP connection
telnet smtp.gmail.com 587
```

### Emails Going to Spam

**Causes:**
- Missing SPF/DKIM records
- Low sender reputation
- Spam-like content
- No unsubscribe link

**Solution:**
- Configure DNS records
- Warm up email domain
- Improve content
- Add unsubscribe option

### "Authentication Failed"

**Causes:**
- Wrong password
- 2FA not configured
- App password not used

**Solution:**
- Verify credentials
- Use app-specific password for Gmail
- Check provider documentation

## üìö Additional Resources

- [SMTP Setup Guide](smtp-setup.md)
- [OAuth Setup Guide](oauth-setup.md)
- [Email Best Practices](https://sendgrid.com/blog/email-best-practices/)

